<!-- templates/products/detail.html -->
{% extends 'base.html' %}

{% block title %}{{ product.name }} - Yüksel İletişim{% endblock %}

{% block content %}
<div class="container">
    <div class="product-detail">
        <div class="product-images">
            <div class="main-image">
                <img src="{{ url_for('static', filename='images/products/' + product.image) }}" 
                     onerror="this.src='/static/images/no-image.png'" 
                     alt="{{ product.name }}">
            </div>
        </div>
        
        <div class="product-info">
            <h1>{{ product.name }}</h1>
            
            <div class="product-price">
                <span class="current-price">{{ "%.2f"|format(product.price) }} TL</span>
            </div>
            
            {% if product.stock > 0 %}
            <div class="product-stock available">
                <i class="fas fa-check-circle"></i> Stokta Var
            </div>
            {% else %}
            <div class="product-stock unavailable">
                <i class="fas fa-times-circle"></i> Stokta Yok
            </div>
            {% endif %}
            
            <div class="product-description">
                {{ product.description }}
            </div>
            
            {% if product.stock > 0 %}
            <div class="add-to-cart-section">
                <div class="quantity-selector">
                    <button class="quantity-btn minus">-</button>
                    <input type="number" value="1" min="1" max="{{ product.stock }}" id="quantity">
                    <button class="quantity-btn plus">+</button>
                </div>
                
                <button class="btn btn-primary add-to-cart" 
                    onclick="addToCart('{{ product.id }}', document.getElementById('quantity').value)">
                    <i class="fas fa-shopping-cart"></i> Sepete Ekle
                </button>
            </div>
            {% endif %}
            
            <div class="product-meta">
                <div class="meta-item">
                    <span class="label">Kategori:</span>
                    <a href="{{ url_for('category_products', category_name=product.category) }}">
                        {{ product.category }}
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    {% if related_products %}
    <div class="related-products">
        <h2>Benzer Ürünler</h2>
        <div class="product-grid">
            {% for related in related_products %}
            {% if related.id != product.id %}
            <div class="product-card">
                <a href="{{ url_for('product_detail', product_id=related.id) }}" class="product-link">
                    <div class="product-image">
                        <img src="{{ url_for('static', filename='images/products/' + related.image) }}"
                             onerror="this.src='/static/images/no-image.png'"
                             alt="{{ related.name }}">
                    </div>
                    <div class="product-info">
                        <h3>{{ related.name }}</h3>
                        <div class="price">{{ "%.2f"|format(related.price) }} TL</div>
                    </div>
                </a>
            </div>
            {% endif %}
            {% endfor %}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const quantityInput = document.getElementById('quantity');
    const minusBtn = document.querySelector('.quantity-btn.minus');
    const plusBtn = document.querySelector('.quantity-btn.plus');
    
    if (minusBtn && plusBtn && quantityInput) {
        minusBtn.addEventListener('click', () => {
            const currentValue = parseInt(quantityInput.value);
            if (currentValue > 1) {
                quantityInput.value = currentValue - 1;
            }
        });
        
        plusBtn.addEventListener('click', () => {
            const currentValue = parseInt(quantityInput.value);
            const maxValue = parseInt(quantityInput.getAttribute('max'));
            if (currentValue < maxValue) {
                quantityInput.value = currentValue + 1;
            }
        });
    }
});
</script>
{% endblock %}